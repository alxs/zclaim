%% Special characters for number sets, e.g. real or complex numbers.
\newcommand{\C}{\mathbb{C}\xspace}
\newcommand{\K}{\mathbb{K}\xspace}
\newcommand{\N}{\mathbb{N}\xspace}
\newcommand{\R}{\mathbb{R}\xspace}
\newcommand{\B}{\mathbb{B}\xspace}
\newcommand{\By}{\mathbb{B}\kern -0.1em\raisebox{0.5ex}{\scalebox{0.7}{$\mathbb{Y}$}}\xspace}
\newcommand{\J}{\mathbb{J}\xspace}
\newcommand{\G}{\mathbb{G}\xspace}
\newcommand{\F}{\mathbb{F}\xspace}

%% Fixed/scaling delimiter examples (see mathtools documentation)
\DeclarePairedDelimiter\abs{\lvert}{\rvert}
\DeclarePairedDelimiter\norm{\lVert}{\rVert}

%% Use the alternative epsilon per default and define the old one as \oldepsilon
\let\oldepsilon\epsilon
\renewcommand{\epsilon}{\ensuremath\varepsilon}

%% Also set the alternate phi as default.
\let\oldphi\phi
\renewcommand{\phi}{\ensuremath{\varphi}}


\numberwithin{equation}{chapter}

\newtheorem{theorem}{Theorem}[chapter]
\newtheorem{example}[theorem]{Example}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}

\newcommand{\xclaim}{\textsc{Xclaim}\xspace}
\newcommand{\zclaim}{\textsc{Zclaim}\xspace}
\newcommand{\cbas}{\textsc{CbA}s\xspace}
\newcommand{\cba}{\textsc{CbA}\xspace}
\newcommand{\isc}{\textsf{iSC}\xspace}


\newcommand\zcashvar[1]{\ensuremath{\mathsf{#1}}\xspace}
\newcommand\zclaimstate[1]{\ensuremath{\mathsf{#1}}\xspace}
\newcommand\zcashdef[1]{\ensuremath{\mathbf{#1}}\xspace}
\newcommand\zcashsig[1]{\ensuremath{\mathtt{#1}}\xspace}
\newcommand\mathvar[1]{\ensuremath{\mathit{#1}}\xspace}
\newcommand\dlt[1]{\ensuremath{\Delta_{#1}}\xspace}

\newcommand{\dvf}{\zcashvar{d}}
\newcommand{\dvfn}{\zcashvar{d_{\n}}}
\newcommand{\dvfnp}{\zcashvar{d_{\n}'}}
\newcommand{\gd}{\zcashvar{g_d}}
\newcommand{\gdstar}{\zcashvar{g_d\star}}
\newcommand{\gdstarn}{\zcashvar{g_d\star_{\n}}}
\newcommand{\gdn}{\zcashvar{{g_d}_{\n}}}
\newcommand{\gdnp}{\zcashvar{{g_d}_{\n}'}}
\newcommand{\pk}{\zcashvar{pk}}
\newcommand{\pkd}{\zcashvar{pk_d}}
\newcommand{\pkdstar}{\zcashvar{pk_d\star}}
\newcommand{\pkdstarn}{\zcashvar{pk_d\star_{\n}}}
\newcommand{\pkdn}{\zcashvar{{pk_d}_{\n}}}
\newcommand{\pkdnp}{\zcashvar{{pk_d}_{\n}'}}
\newcommand{\coll}{\zcashvar{coll}}
\newcommand{\xr}{\zcashvar{xr}}
\newcommand{\dpa}{\ensuremath{(\dvf,\, \pkd)}\xspace}
\newcommand{\sk}{\zcashvar{sk}}
\newcommand{\ask}{\zcashvar{ask}}
\newcommand{\nsk}{\zcashvar{nsk}}
\newcommand{\ovk}{\zcashvar{ovk}}
\newcommand{\ivk}{\zcashvar{ivk}}
\newcommand{\nk}{\zcashvar{nk}}
\newcommand{\ak}{\zcashvar{ak}}
\newcommand{\rsk}{\zcashvar{rsk}}
\newcommand{\rk}{\zcashvar{rk}}

\newcommand{\rcm}{\zcashvar{rcm}}
\newcommand{\rcmn}{\zcashvar{rcm_{\n}}}
\newcommand{\rcmnp}{\zcashvar{rcm_{\n}'}}
\newcommand{\rcn}{\zcashvar{rcn}}
\newcommand{\rcnn}{\zcashvar{rcn_{\n}}}
\newcommand{\rcv}{\zcashvar{rcv}}
\newcommand{\rcvn}{\zcashvar{rcv_{\n}}}
\newcommand{\rcr}{\zcashvar{rcr}}
\newcommand{\rcb}{\zcashvar{rcb}}

\newcommand{\val}{\zcashvar{v}}
\newcommand{\valn}{\zcashvar{v_{\n}}}
\newcommand{\valnp}{\zcashvar{v_{\n}'}}
\newcommand{\vtot}{\zcashvar{v_{tot}}}
\newcommand{\vmax}{\zcashvar{v_{max}}}
\newcommand{\vmin}{\zcashvar{v_{min}}}
\newcommand{\cv}{\zcashvar{cv}}
\newcommand{\cvn}{\zcashvar{cv_{\n}}}
\newcommand{\crem}{\zcashvar{cr}}
\newcommand{\bal}{\zcashvar{b}}
\newcommand{\cb}{\zcashvar{cb}}
\newcommand{\rt}{\zcashvar{rt}}
\newcommand{\rtn}{\zcashvar{rt_{\n}}}
\newcommand{\nf}{\zcashvar{nf}}
\newcommand{\memo}{\zcashvar{memo}}
\newcommand{\lby}{\zcashvar{leadByte}}
\newcommand{\cm}{\zcashvar{cm}}
\newcommand{\cmu}{\zcashvar{cm_{\mathnormal{u}}}}
\newcommand{\cmun}{\zcashvar{{cm_{\mathnormal{u}}}_{\n}}}
\newcommand{\cmunp}{\zcashvar{{cm_{\mathnormal{u}}}_{\n}'}}
\newcommand{\epk}{\zcashvar{epk}}
\newcommand{\epkn}{\zcashvar{epk_{\n}}}
\newcommand{\emk}{\zcashvar{emk}}
\newcommand{\emsk}{\zcashvar{emsk}}
\newcommand{\esk}{\zcashvar{esk}}
\newcommand{\eskn}{\zcashvar{esk_{\n}}}
\newcommand{\shared}{\zcashvar{sharedSecret}}
\newcommand{\Shared}{\zcashvar{SharedSecret}}
\newcommand{\penc}{\zcashvar{P^{enc}}}
\newcommand{\pencn}{\zcashvar{{P^{enc}}_{\n}}}
\newcommand{\kenc}{\zcashvar{K^{enc}}}
\newcommand{\kencn}{\zcashvar{{K^{enc}}_{\n}}}
\newcommand{\nenc}{\zcashvar{N^{enc}}}
\newcommand{\cenc}{\zcashvar{C^{enc}}}
\newcommand{\cencn}{\zcashvar{{C^{enc}}_{\n}}}
\newcommand{\cout}{\zcashvar{C^{out}}}
\newcommand{\sighashvar}{\zcashvar{SigHash}}
\newcommand{\rlhash}{\zcashvar{RequestLockHash}}
\newcommand{\mhash}{\zcashvar{MintHash}}
\newcommand{\cihash}{\zcashvar{ConfirmIssueHash}}
\newcommand{\clihash}{\zcashvar{ChallengeIssueHash}}
\newcommand{\pth}{\zcashvar{path}}
\newcommand{\pthn}{\zcashvar{path_{\n}}}
\newcommand{\posn}{\zcashvar{pos_{\n}}}
\newcommand{\leftn}{\zcashvar{left}}
\newcommand{\rightn}{\zcashvar{right}}
\newcommand{\parity}{\zcashvar{parity}}
\newcommand{\hashvar}{\zcashvar{hash}}
\newcommand{\sib}{\zcashvar{sibling}}
\newcommand{\rem}{\zcashvar{rem}}
\newcommand{\acci}{\zcashvar{accepts\_issue}}
\newcommand{\accr}{\zcashvar{accepts\_redeem}}
\newcommand{\nlock}{\zcashvar{n_{permit}}}
\newcommand{\issue}{\zcashvar{issue}}
\newcommand{\enc}{\zcashvar{enc}}
\newcommand{\repr}{\zcashvar{repr}}
\newcommand{\reprj}{\repr_{\J}}
\newcommand{\new}{\zcashvar{new}}
\newcommand{\old}{\zcashvar{old}}
\newcommand{\mx}{\zcashvar{max}}
\newcommand{\mn}{\zcashvar{min}}
\newcommand{\hj}{\ensuremath{h_\J}\xspace}
\newcommand{\rj}{\ensuremath{r_\J}\xspace}
\newcommand{\frj}{\ensuremath{\F_{\rj}}\xspace}


\newcommand{\kas}{\zcashvar{KA^{Sapling}}}
\newcommand{\kdfs}{\zcashvar{KDF^{Sapling}}}
\newcommand{\reddsa}{\zcashvar{RedDSA}}
\newcommand{\redjj}{\zcashvar{RedJubjub}}
\newcommand{\divhash}{\zcashvar{DiversifyHash}}
\newcommand{\fgh}{\zcashvar{FindGroupHash}^{\J^{(r)*}}\xspace}
\newcommand{\extractj}{\zcashvar{Extract}_{\J^{(r)}}\xspace}
\newcommand{\mas}{\zcashvar{MintingSig}}
\newcommand{\vaultsig}{\zcashvar{VaultSig}}
\newcommand{\sym}{\zcashvar{Sym}}
\newcommand{\symc}{\zcashvar{Sym}.\mathbf{C}\xspace}
\newcommand{\vcm}{\zcashvar{ValueCommit}}
\newcommand{\ncm}[1][]{\zcashvar{NoteCommit^{Sapling}_{#1}}}
\newcommand{\nncm}{\zcashvar{NonceCommit}}
\newcommand{\mds}{\zcashvar{MerkleDepth^{Sapling}}}
\newcommand{\sighashall}{\zcashvar{SIGHASH\_ALL}}
\newcommand{\hash}{\zcashvar{HashValue}}
\newcommand{\mcrh}{\zcashvar{MerkleCRH^{Sapling}}}
\newcommand{\wpc}{\zcashvar{WindowedPedersenCommit}}

\newcommand{\priv}{\zcashvar{Private}}
\newcommand{\pub}{\zcashvar{Public}}
\newcommand{\ppo}{\zcashvar{PublicPrimeSubgroup}}
\newcommand{\derivepub}{\zcashvar{DerivePublic}}
\newcommand{\agree}{\zcashvar{Agree}}
\newcommand{\encr}{\zcashvar{Encrypt}}
\newcommand{\decr}{\zcashvar{Decrypt}}
\newcommand{\sign}{\zcashvar{Sign}}
\newcommand{\validate}{\zcashvar{Validate}}
\newcommand{\inp}{\zcashvar{Input}}
\newcommand{\out}{\zcashvar{Output}}
\newcommand{\signature}{\zcashvar{Signature}}
\newcommand{\proof}{\zcashvar{Proof}}
\newcommand{\gent}{\zcashvar{GenTrapdoor()}}
\newcommand{\genp}{\zcashvar{GenPrivate()}}

\newcommand{\itolebsp}{\zcashvar{I2LEBSP}}
\newcommand{\itobebsp}{\zcashvar{I2BEBSP}}
\newcommand{\lebstoip}{\zcashvar{LEBS2IP}}
\newcommand{\leostoip}{\zcashvar{LEOS2IP}}
\newcommand{\lebstoosp}{\zcashvar{LEBS2OSP}}
\newcommand{\leostobsp}{\zcashvar{LEOS2BSP}}

\newcommand{\ld}{\ensuremath{\ell_{\zcashvar{d}}}\xspace}
\newcommand{\lj}{\ensuremath{\ell_{\J}}\xspace}
\newcommand{\lms}{\ensuremath{\ell_{\zcashvar{MerkleSapling}}}\xspace}
\newcommand{\lval}{\ensuremath{\ell_{\zcashvar{value}}}\xspace}
\newcommand{\livk}{\ensuremath{\ell_{\zcashvar{ivk}}}\xspace}
\newcommand{\lscalar}{\ensuremath{\ell_{\zcashvar{scalar}}}\xspace}
\newcommand{\lvalueI}{\ensuremath{\ell_{\zcashvar{value}^I}}\xspace}
\newcommand{\lxrn}{\ensuremath{\ell_{\zcashvar{xr}_n}}\xspace}
\newcommand{\lxrG}{\ensuremath{\ell_{\zcashvar{xr}_G}}\xspace}
\newcommand{\lf}{\ensuremath{\ell_{f}}\xspace}
\newcommand{\lqsstd}{\ensuremath{\ell_{q_{\sigma_{std}}}}\xspace}
\newcommand{\sstd}{\ensuremath{\sigma_{std}}\xspace}
\newcommand{\smin}{\ensuremath{\sigma_{min}}\xspace}

\newcommand{\blakeb}{\zcashvar{BLAKE2b}}
\newcommand{\blakes}{\zcashvar{BLAKE2s}}
\newcommand{\blakezclaim}{\zcashvar{BLAKE2b\text{-}256}}
\newcommand{\shacompress}{\zcashvar{SHA256Compress}}
\newcommand{\shatwo}{\zcashvar{SHA\text{-}256}}
\newcommand{\shafive}{\zcashvar{SHA\text{-}512}}
\newcommand{\aead}{\zcashvar{AEAD\_CHACHA20\_POLY1305}}
\newcommand{\groth}{\ensuremath{\operatorname{Groth16}}\xspace}
\newcommand{\sighash}{\ensuremath{\operatorname{SIGHASH}}\xspace}
\newcommand{\prevheader}{\zcashvar{PREV\_HEADER}}
\newcommand{\prevhash}{\zcashvar{PREV\_HASH}}

\newcommand{\n}{\zcashdef{n}}
\newcommand{\np}{\zcashdef{np}}

\newcommand{\sas}{\zcashsig{spendAuthSig}}
\newcommand{\rlsig}{\zcashsig{requestLockSig}}
\newcommand{\sig}{\zcashsig{mintSig}}
\newcommand{\icsig}{\zcashsig{issueConfSig}}
\newcommand{\rcsig}{\zcashsig{redeemConfSig}}
\newcommand{\zclaimcv}{\zcashsig{ZCLAIM\_derive\_cv}}
\newcommand{\zclaimm}{\zcashsig{ZCLAIM\_Mint\_Sign}}
\newcommand{\zclaimnl}{\zcashsig{ZCLAIM\_lock\_perm}}
\newcommand{\hashmints}{\zcashsig{hashShieldedMints}}
\newcommand{\hashburns}{\zcashsig{hashShieldedBurns}}
\newcommand{\hfsr}{\zcashsig{hashFinalSaplingRoot}}
\newcommand{\hpv}{\zcashsig{hashPrevBlock}}
\newcommand{\ephkey}{\zcashsig{ephemeralKey}}

\newcommand\zksnark[1]{\ensuremath{\pi_{\mathsf{#1}}}\xspace}
\newcommand{\pis}{\zksnark{ZKSpend}}
\newcommand{\pio}{\zksnark{ZKOutput}}
\newcommand{\zkm}{\zcashvar{ZKMint}}
\newcommand{\zkb}{\zcashvar{ZKBurn}}
\newcommand{\pim}{\zksnark{ZKMint}}
\newcommand{\pib}{\zksnark{ZKBurn}}
\newcommand{\pic}{\zksnark{ZKChallenge}}
\newcommand{\pipob}{\zksnark{ZKPOB}}
\newcommand{\pipoc}{\zksnark{ZKPOC}}
\newcommand{\pipoi}{\zksnark{ZKPOI}}

\newcommand{\statevr}{\zclaimstate{VaultRegistered}}
\newcommand{\stateni}{\zclaimstate{VaultNotIssuing}}
\newcommand{\statenr}{\zclaimstate{VaultNotRedeeming}}

\newcommand{\statevai}{\zclaimstate{VaultAcceptingIssue}}
\newcommand{\stateam}{\zclaimstate{AwaitingMint}}
\newcommand{\statemt}{\zclaimstate{MintTimeout}}
\newcommand{\stateaic}{\zclaimstate{AwaitingIssueConfirm}}
\newcommand{\stateict}{\zclaimstate{IssueConfirmTimeout}}
\newcommand{\stateic}{\zclaimstate{IssueChallenged}}
\newcommand{\stateis}{\zclaimstate{IssueSuccess}}

\newcommand{\statevar}{\zclaimstate{Vault\-Accepting\-Redeem}}
\newcommand{\statearc}{\zclaimstate{AwaitingRedeemConfirm}}
\newcommand{\staterct}{\zclaimstate{RedeemConfirmTimeout}}
\newcommand{\staterc}{\zclaimstate{RedeemChallenged}}
\newcommand{\staters}{\zclaimstate{RedeemSuccess}}

\newcommand{\statess}{\zclaimstate{StartingState}}
\newcommand{\stateos}{\zclaimstate{OutputState}}

\newcommand{\requestLockop}{\mathvar{requestLock}}
\newcommand{\lockop}{\mathvar{lock}}
\newcommand{\mintop}{\mathvar{mint}}
\newcommand{\burnop}{\mathvar{burn}}
\newcommand{\challengeIssueop}{\mathvar{challengeIssue}}
\newcommand{\challengeRedeemop}{\mathvar{challengeRedeem}}
\newcommand{\releaseop}{\mathvar{release}}
\newcommand{\confirmIssueop}{\mathvar{confirmIssue}}
\newcommand{\confirmRedeemop}{\mathvar{confirmRedeem}}
\newcommand{\submitPOBop}{\mathvar{submitPOB}}
\newcommand{\submitPOCop}{\mathvar{submitPOC}}
\newcommand{\submitPOIop}{\mathvar{submitPOI}}
\newcommand{\rebalanceop}{\mathvar{rebalance}}

\newcommand{\requestLock}{\zclaimstate{requestLock}}
\newcommand{\lock}{\zclaimstate{lock}}
\newcommand{\mint}{\zclaimstate{mint}}
\newcommand{\burn}{\zclaimstate{burn}}
\newcommand{\challengeIssue}{\zclaimstate{challengeIssue}}
\newcommand{\challengeRedeem}{\zclaimstate{challengeRedeem}}
\newcommand{\release}{\zclaimstate{release}}
\newcommand{\confirmIssue}{\zclaimstate{confirmIssue}}
\newcommand{\confirmRedeem}{\zclaimstate{confirmRedeem}}
\newcommand{\submitPOB}{\zclaimstate{submitPOB}}
\newcommand{\submitPOC}{\zclaimstate{submitPOC}}
\newcommand{\submitPOI}{\zclaimstate{submitPOI}}
\newcommand{\rebalance}{\zclaimstate{rebalance}}

\newcommand{\dm}{\dlt{\mathvar{mint}}}
\newcommand{\dci}{\dlt{\mathvar{confirmIssue}}}
\newcommand{\dcr}{\dlt{\mathvar{confirmRedeem}}}

\newcommand{\iw}{\ensuremath{ICN_w}\xspace}
\newcommand{\issuer}{\textsc{issuer}\xspace}
\newcommand{\redeemer}{\textsc{redeemer}\xspace}
\newcommand{\vault}{\textsc{vault}\xspace}
\newcommand{\rcvmi}{\ensuremath{{\rcv_{\zcashvar{m}}}_i}\xspace}
\newcommand{\vmi}{\ensuremath{{\val_{\zcashvar{m}}}_i}\xspace}
\newcommand{\rcvbj}{\ensuremath{{\rcv_{\zcashvar{b}}}_j}\xspace}
\newcommand{\vbj}{\ensuremath{{\val_{\zcashvar{b}}}_j}\xspace}

\newcommand{\oxr}{\ensuremath{\mathcal{O}_{\mathsf{xr}}}\xspace}
